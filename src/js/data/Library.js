/* src/js/data/Library.js */

// å®šä¹‰ç³»ç»Ÿä¹¦ç±å†…å®¹
const GUIDE_BOOK_I = {
    id: "guide_book_part1",
    title: "ä¼Šè¨å¡æ‰‹è®° I",
    cover: "assets/images/booksheet/booksheet0.png",
    date: "ç³»ç»ŸæŒ‡å—",
    isReadOnly: true, // ğŸ”’ æ ¸å¿ƒæ ‡è®°ï¼šåªè¯»
    content: `
# ç¬¬ä¸€ç«  åºè¨€
> ä¸€ä¸ªåœ¨è¿‡å»ã€ç°åœ¨å’Œæœªæ¥çš„ç­¹åˆ’ä¸­å®šä½è‡ªå·±ï¼Œå…·æœ‰è¯­è¨€èƒ½åŠ›çš„æˆå¹´äººï¼Œæ˜¯åœ¨å™äº‹ä¸­å±•å¼€ä»–çš„è¡ŒåŠ¨å’Œç”Ÿæ´»çš„ã€‚

æœ¬ä¹¦çš„åŸå‹ï¼Œæºè‡ªåŠ é‡Œæ•¦å­¦é™¢ï¼ˆGaryton Collegeï¼‰çš„ä¸€é—¨æ ¸å¿ƒè¯¾ç¨‹â€”â€”Rhet324: å™äº‹ç†è®ºã€‚

åœ¨æœ€åˆçš„æ•™å­¦å¤§çº²ä¸­ï¼Œæˆ‘ä»¬è‡´åŠ›äºåŒå­¦ç”Ÿä»¬ä¸€é“ï¼Œåœ¨ç¹å¤çš„æ–‡å­¦ä¸å“²å­¦æ–‡æœ¬ä¸­æ¸…ç†å‡ºå…³äºâ€œå™äº‹â€çš„è„‰ç»œã€‚ç„¶è€Œï¼Œéšç€ç ”è®¨çš„æ·±å…¥ï¼Œä¸€ä¸ªæ›´ä¸ºè¿«åˆ‡çš„é‡å¿ƒé€æ¸æµ®å‡ºæ°´é¢ï¼šå™äº‹ç†è®ºæ›´åº”æ˜¯æ¯ä¸€ä¸ªç°ä»£äººç†è§£è‡ªèº«å¤„å¢ƒçš„ç”Ÿå­˜å·¥å…·ã€‚

æ­£å¦‚æˆ‘ä»¬åœ¨è¯¾ç¨‹ä¼Šå§‹æ‰€å¼•ç”¨çš„é‚£æ ·ï¼šâ€œä¸€ä¸ªåœ¨è¿‡å»ã€ç°åœ¨å’Œæœªæ¥çš„ç­¹åˆ’ä¸­å®šä½è‡ªå·±ï¼Œå…·æœ‰è¯­è¨€èƒ½åŠ›çš„æˆå¹´äººï¼Œæ˜¯åœ¨å™äº‹ä¸­å±•å¼€ä»–çš„è¡ŒåŠ¨å’Œç”Ÿæ´»çš„ã€‚â€è¿™å¥ç•¥æ˜¾æ™¦æ¶©çš„å®šä¹‰ï¼Œå®åˆ™é“å‡ºäº†æˆ‘ä»¬å­˜åœ¨çš„çœŸç›¸â€”â€”æˆ‘ä»¬å¹¶éä»…ä»…æ´»åœ¨ç‰©ç†æ—¶é—´çš„æµé€ä¸­ï¼Œä¹Ÿæ˜¯æ´»åœ¨è‡ªå·±ç¼–ç»‡çš„æ•…äº‹é‡Œã€‚

ä¸ºäº†å°†è¿™ä¸€å­¦æœ¯æ´è§è½¬åŒ–ä¸ºæ›´å…·æ™®é€‚æ€§çš„ç”Ÿæ´»æŒ‡å—ï¼Œæˆ‘ä»¬åœ¨åŸæ•™æçš„åŸºç¡€ä¸Šè¿›è¡Œäº†å¤§å¹…åº¦çš„æ”¹å†™ä¸æ‰©å……ã€‚æœ¬ä¹¦è¯•å›¾è·¨è¶Šç†è®ºä¸ç”Ÿæ´»çš„é¸¿æ²Ÿï¼Œé€šè¿‡äº”ä¸ªç¯‡ç« çš„æ—…ç¨‹ï¼Œå›ç­”é‚£ä¸ªå¤è€è€Œå¸¸æ–°çš„é—®é¢˜ï¼šâ€œæˆ‘â€æ˜¯è°ï¼Ÿ

* **ç¬¬ä¸€ç«  åºè¨€** å°†ä½œä¸ºå…¨ä¹¦çš„å¯¼è®ºï¼Œæ—¨åœ¨å‹¾å‹’æœ¬ä¹¦çš„åŸºæœ¬è§‚ç‚¹ã€‚ 
* **ç¬¬äºŒç«  å™äº‹ç†è®º** æˆ‘ä»¬å°†æ·±å…¥â€œå™äº‹è½¬å‘â€ï¼ˆNarrative Turnï¼‰çš„æµªæ½®ï¼Œå‘è¯»è€…ä»‹ç»ä¸¤è‚¡è‡³å…³é‡è¦çš„ä¼ ç»Ÿï¼šä¸€æ˜¯ä¾§é‡ä¸ªä½“è‡ªæˆ‘ç†è§£çš„è¯ é‡Šå­¦ä¼ ç»Ÿï¼ŒäºŒæ˜¯ä¾§é‡ç¤¾ä¼šäº¤å¾€ä¸å…¬å…±è¡ŒåŠ¨çš„ç¤¾ä¼šæ‰¹åˆ¤ç†è®ºä¼ ç»Ÿã€‚å‰è€…å…³ä¹æˆ‘ä»¬å¦‚ä½•åœ¨æ—¶é—´ä¸­é€šè¿‡å™äº‹å»ºæ„åŒä¸€æ€§ï¼Œåè€…åˆ™æé†’æˆ‘ä»¬ï¼Œä¸ªä½“çš„å™äº‹æ°¸è¿œæ˜¯åœ¨ä¸ç¤¾ä¼šä¸»æµå™äº‹çš„äº¤äº’ä¸æŠ—äº‰ä¸­å½¢æˆçš„ã€‚
* **ç¬¬ä¸‰ç«  åŸå‹å›å½’ï¼šã€Šå¥¥å¾·èµ›ã€‹** å°†å¸¦é¢†è¯»è€…è¿›è¡Œä¸€æ¬¡åŸå‹çš„å›å½’ã€‚æˆ‘ä»¬å°†é‡è¯»è¥¿æ–¹å™äº‹çš„æºå¤´â€”â€”è·é©¬çš„ã€Šå¥¥å¾·èµ›ã€‹ï¼Œå»å®¡è§†åœ¨ä¸€ä¸ªå¤å…¸ä¸–ç•Œä¸­ï¼Œâ€œå½’ä¹¡â€ä¸â€œèº«ä»½ç¡®ç«‹â€æ˜¯å¦‚ä½•é€šè¿‡å™äº‹å®Œæˆçš„ã€‚ç„¶è€Œå½“æˆ‘ä»¬æŠŠç›®å…‰æ‹‰å›å†·å³»çš„ç°å®ã€‚é€šè¿‡å¯¹æ¯”ä»Šå¤©çš„â€œç°ä»£å¥¥å¾·ä¿®æ–¯â€ä¸å¤å¸Œè…Šè‹±é›„çš„å¤„å¢ƒå·®å¼‚ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ï¼Œå½“å¤–éƒ¨ä¸–ç•Œä¸å†æä¾›åšå›ºçš„åæ ‡æ—¶ï¼Œæˆ‘ä»¬çš„ç”Ÿæ´»é¢ä¸´ç€æ€æ ·çš„æ–­è£‚å±æœºã€‚
* **ç¬¬å››ç«  ä½œä¸ºè§£å†³æ–¹æ¡ˆçš„ä¹¦å†™** åˆ™æå‡ºäº†æœ€ç»ˆçš„è¡ŒåŠ¨æŒ‡å—ï¼šåœ¨æµåŠ¨çš„ç°ä»£æ€§ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ä¸»åŠ¨çš„å™äº‹è¡Œä¸ºï¼Œåœ¨ç¢ç‰‡åŒ–çš„åºŸå¢Ÿä¸Šé‡å»ºæ„ä¹‰çš„å±…æ‰€ã€‚

è¿™ä¸ä»…ä»…æ˜¯ä¸€æœ¬æ•™æï¼Œæ›´æ˜¯ä¸€ä»½é‚€è¯·ã€‚é‚€è¯·ä½ æ‹¿èµ·ç¬”ï¼Œåœ¨ç”Ÿæ´»çš„ç¢ç‰‡ä¸­ï¼Œæ‰¾åˆ°ä½ çš„ä¼Šè¨å¡ï¼Œç¡®ç«‹ä½ çš„èˆªå‘ã€‚

---

## ç¬¬äºŒç« ï¼šå™äº‹ç†è®º

åœ¨è¿›å…¥ä¹¦å†™å®è·µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆç»˜åˆ¶ä¸€å¼ åœ°å›¾ã€‚å½“ä¸‹çš„å­¦æœ¯ç•Œæ­£ç»å†ç€ä¸€åœºæ·±åˆ»çš„â€œå™äº‹è½¬å‘â€ï¼ˆNarrative Turnï¼‰ï¼Œå­¦è€…ä»¬ä¸å†ä»…ä»…æŠŠæ•…äº‹çœ‹ä½œæ–‡å­¦ä½œå“ï¼Œè€Œæ˜¯å°†å…¶è§†ä¸ºäººç±»ç†è§£ä¸–ç•Œå’Œè‡ªæˆ‘çš„åŸºæœ¬å½¢å¼ã€‚è¿™ä¸€è½¬å‘å¯ä»¥æ¢³ç†ä¸ºä¸¤è‚¡ä¸»è¦çš„ç†è®ºä¼ ç»Ÿï¼š

### 1. è¯ é‡Šå­¦ä¼ ç»Ÿï¼šä½œä¸ºè‡ªæˆ‘ç†è§£çš„å™äº‹
ç¬¬ä¸€è‚¡ä¼ ç»Ÿå…³æ³¨ä¸ªä½“çš„å†…åœ¨æ—¶é—´ä¸åŒä¸€æ€§ï¼Œä¸»è¦ç”±ç°è±¡å­¦ä¸ä¼¦ç†å­¦å“²å­¦å®¶æ‰€ä¸»å¯¼ã€‚

ä¿ç½—Â·åˆ©ç§‘ï¼ˆPaul Ricoeurï¼‰åœ¨æ­¤æä¾›äº†ä¸€ä¸ªå…³é”®çš„åŒºåˆ†ï¼šä½œä¸ºâ€œåŒä¸€æ€§â€ï¼ˆIdemï¼‰çš„è‡ªæˆ‘ä¸ä½œä¸ºâ€œè‡ªèº«æ€§â€ï¼ˆIpseï¼‰çš„è‡ªæˆ‘ã€‚å‰è€…æ˜¯ç”Ÿç‰©å­¦æ„ä¹‰ä¸Šçš„æŒä¹…ï¼Œè€Œåè€…æ˜¯æ‰¿è¯ºä¸è´£ä»»çš„ä¸»ä½“ã€‚åˆ©ç§‘è®¤ä¸ºï¼Œè¿æ¥è¿™ä¸¤è€…çš„æ¡¥æ¢æ­£æ˜¯å™äº‹ã€‚

è¿™ä¸€å“²å­¦æ´è§å¾—åˆ°äº†å¹¿æ³›çš„å…±é¸£ï¼šéº¦é‡‘æ³°å°”ï¼ˆAlasdair MacIntyreï¼‰åœ¨å…¶å¾·æ€§ä¼¦ç†å­¦ä¸­è®ºè¯ï¼Œäººç±»æœ¬è´¨ä¸Šæ˜¯â€œè®²æ•…äº‹çš„åŠ¨ç‰©â€ã€‚ä»–è®¤ä¸ºï¼Œæˆ‘ä»¬åªæœ‰å°†ç”Ÿæ´»è§†ä¸ºå…·æœ‰â€œå™äº‹ç»Ÿä¸€æ€§â€çš„æ•´ä½“ï¼Œæ‰èƒ½ç†è§£è‡ªæˆ‘çš„è¡ŒåŠ¨ä¸å¾·æ€§ã€‚
è€ŒæŸ¥å°”æ–¯Â·æ³°å‹’ï¼ˆCharles Taylorï¼‰ åˆ™æŒ‡å‡ºï¼Œè‡ªæˆ‘æ˜¯å­˜åœ¨äºé“å¾·ç©ºé—´ä¸­çš„å¯¼èˆªã€‚è¦æƒ³çŸ¥é“â€œæˆ‘æ˜¯è°â€ï¼Œå¿…é¡»çŸ¥æ™“æˆ‘ç«™åœ¨ä½•å¤„ï¼ˆé“å¾·ç«‹åœºï¼‰ï¼Œè€Œå™äº‹ä¸ºè¿™ç§å®šä½æä¾›äº†å¿…è¦çš„åæ ‡ã€‚

ç®€è¨€ä¹‹ï¼Œåœ¨è¿™ä¸€ä¼ ç»Ÿçœ‹æ¥ï¼Œä¹¦å†™æ˜¯ä¸€ç§æœ¬ä½“è®ºæ„ä¹‰ä¸Šçš„å»ºæ„â€”â€”æˆ‘ä»¬é€šè¿‡è®²è¿°ï¼Œå°†ç ´ç¢çš„äº‹ä»¶æ•´åˆä¸ºè¿è´¯çš„æ•…äº‹ï¼Œä»è€Œåœ¨æ—¶é—´ä¸­ç¡®ç«‹è‡ªæˆ‘ã€‚

### 2. ç¤¾ä¼šæ‰¹åˆ¤ä¼ ç»Ÿï¼šä½œä¸ºå…¬å…±è¡ŒåŠ¨çš„å™äº‹
ç¬¬äºŒè‚¡ä¼ ç»Ÿåˆ™å°†ç›®å…‰æŠ•å‘å¤–éƒ¨ä¸–ç•Œä¸äººé™…å…³ç³»ï¼Œè¿™ä¸€è„‰ç»œå—æ”¿æ²»å“²å­¦ä¸æ‰¹åˆ¤ç†è®ºçš„å½±å“æ·±è¿œã€‚

å—æ±‰å¨œÂ·é˜¿ä¼¦ç‰¹ï¼ˆHannah Arendtï¼‰å¯å‘ï¼Œè¿™ä¸€ä¼ ç»Ÿå¼ºè°ƒå™äº‹ä¸ä»…ä»…æ˜¯è‡ªæˆ‘çš„ç‹¬ç™½ï¼Œæ›´æ˜¯è¿›å…¥å…¬å…±ä¸–ç•Œçš„â€œå±•ç¤ºâ€ï¼ˆAppearanceï¼‰ã€‚
é˜¿ä¼¦ç‰¹ä¸åæ¥çš„çº¦å°”æ ¹Â·å“ˆè´é©¬æ–¯ï¼ˆJÃ¼rgen Habermasï¼‰ç­‰äººæŒ‡å‡ºï¼Œå™äº‹æ˜¯ä¸€ç§ç¤¾ä¼šäº¤å¾€ä¸æ²Ÿé€šçš„é‡è¦å½¢å¼ã€‚å¹¶æ²¡æœ‰ä¸€ä¸ªå­¤ç«‹çš„â€œæˆ‘â€åœ¨è®²æ•…äº‹ï¼Œæˆ‘ä»¬çš„æ•…äº‹æ€»æ˜¯äº¤ç»‡åœ¨äººç±»å…³ç³»çš„â€œç½‘â€ä¸­ã€‚

æ­£å¦‚å½“ä»£å¥³æ€§ä¸»ä¹‰æ‰¹åˆ¤ç†è®ºå®¶æ‰€è¨€ï¼Œèº«ä»½è®¤åŒæ˜¯ç”±ç¤¾ä¼šæ–‡åŒ–ç¯å¢ƒå¡‘é€ çš„ã€‚ç¤¾ä¼šé€šè¿‡ä¸»æµå™äº‹ï¼ˆMaster Narrativesï¼‰ä¸ºä¸ªä½“æä¾›å‰§æœ¬ï¼ˆå¦‚æ€§åˆ«è§’è‰²ã€æˆåŠŸæ ‡å‡†ï¼‰ã€‚
ä½†è¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬æ˜¯å®Œå…¨è¢«åŠ¨çš„ã€‚ä¸ªä½“ä¸ç¤¾ä¼šåœ¨è¯­è¨€å±‚é¢è¿›è¡Œç€æŒç»­çš„äº¤äº’å»ºæ„ã€‚é€šè¿‡ä¹¦å†™ï¼Œä¸ªä½“ä¸ä»…æ˜¯åœ¨ç¡®è®¤è‡ªæˆ‘ï¼Œæ›´å¯èƒ½æ˜¯åœ¨æŒ‘æˆ˜éœ¸æƒå™äº‹ï¼Œé€šè¿‡â€œåå™äº‹â€æ¥é‡å¡‘ç¤¾ä¼šå›¾æ™¯ã€‚

**ç»¼ä¸Šæ‰€è¿°ï¼š**

å™äº‹ä¸€æ–¹é¢è¢«çœ‹ä½œä¸€ç§ä»¥ç¬¬ä¸€äººç§°è§†è§’ç†è§£å’Œåˆç†åŒ–æˆ‘ä»¬ç”Ÿæ´»çš„åŠªåŠ›ï¼›ä½†å¦ä¸€æ–¹é¢ï¼Œå®ƒåˆå¿…ç„¶ä¸ç¤¾ä¼šäº¤å¾€ã€å…¬å…±ç”Ÿæ´»ç´§å¯†ç›¸è¿ã€‚
å°½ç®¡äºŒè€…åœ¨ç°å®ä¸­æ˜¯ç›¸äº’æ¸—é€ã€éš¾è§£éš¾åˆ†çš„ï¼Œä½†åœ¨æœ¬ä¹¦çš„æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒä»¬åˆ†åˆ«å¤„ç†ä¸º**â€œå™äº‹ä¸è‡ªæˆ‘æ„å»ºâ€**ï¼ˆNarrative and Self-Constructionï¼‰å’Œ**â€œå™äº‹ä¸ç¤¾ä¼šâ€**ï¼ˆNarrative and Societyï¼‰è¿™ä¸¤ä¸ªç»´åº¦ã€‚

---

## ç¬¬ä¸‰ç« ï¼šåŸå‹å›å½’ï¼šã€Šå¥¥å¾·èµ›ã€‹ä¸ç°ä»£å¥¥å¾·ä¿®æ–¯

å®é™…ä¸Šï¼Œè¿™ç§â€œå™äº‹å»ºæ„è‡ªæˆ‘â€çš„æœºåˆ¶ï¼Œå¹¶éç°ä»£å‘æ˜ã€‚é€šè¿‡å¯¹è·é©¬å²è¯—ã€Šå¥¥å¾·èµ›ã€‹çš„æ–‡æœ¬ç»†è¯»ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¸­éšå«çš„åŒé‡å™äº‹ç­–ç•¥ã€‚

å¥¥å¾·ä¿®æ–¯çš„è¿˜ä¹¡æ˜¯ä¸€åœºèº«ä»½çš„é‡å»ºã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ä»–åœ¨ä¸¤ä¸ªä¸åŒåœºåŸŸçš„å™äº‹å±•æ¼”ï¼š

1.  **å…¬å…±åœºåŸŸï¼ˆè´¹åŸƒå…‹æ–¯å®«æ®¿ï¼‰**ï¼šé¢å¯¹é˜¿å°”åŸºè¯ºå¥¥æ–¯ç‹ä¸æ»¡åº§å®¾å®¢ï¼Œå¥¥å¾·ä¿®æ–¯é€šè¿‡å®å¤§çš„å£å¤´æ¼”è¯´ï¼Œå°†æµ·ä¸Šæ¼‚æ³Šçš„ç¦»æ•£ç»éªŒæ•´åˆè¿›â€œæ‹‰ä¼Šå°”ææ–¯ä¹‹å­â€çš„è‹±é›„è°±ç³»ä¸­ã€‚è¿™æ˜¯ **ç¤¾ä¼šèº«ä»½ï¼ˆSocial Identityï¼‰** çš„ç¡®è®¤ã€‚
2.  **ç§å¯†åœºåŸŸï¼ˆç‰§çŒªå¥´çš„èŒ…èˆï¼‰**ï¼šåœ¨é‡è¿”å®«æ®¿å‰ï¼Œä»–å…ˆåœ¨è¾¹ç¼˜çš„èŒ…èˆä¸­é€šè¿‡ä¼ªè£…ä¸ä½è¯­ï¼Œè®²è¿°äº†å…³äºå—éš¾ã€å¿è€ä¸å‘½è¿æ— å¸¸çš„æ•…äº‹ã€‚è¿™æ˜¯ **å†…åœ¨è‡ªæˆ‘ï¼ˆInner Selfï¼‰** çš„æŠšæ…°ä¸æ•´åˆã€‚

è¿™ç§â€œå®«æ®¿-èŒ…èˆâ€çš„äºŒå…ƒç»“æ„ï¼Œæ­ç¤ºäº†å™äº‹åŠŸèƒ½çš„å®Œæ•´æ€§ï¼šå®ƒæ—¢æ˜¯ä¸ªä½“å‘ç¤¾ä¼šçš„æŠ•å°„ï¼Œä¹Ÿæ˜¯ä¸ªä½“å¯¹å†…å¿ƒçš„è§‚ç…§ã€‚

ç„¶è€Œï¼Œå°†å¤å…¸ç»éªŒç§»æ¤åˆ°å½“ä»£ç¤¾ä¼šæ—¶ï¼Œæˆ‘ä»¬é­é‡äº†**é½æ ¼è’™ç‰¹Â·é²æ›¼ï¼ˆZygmunt Baumanï¼‰** æ‰€è¨€çš„â€œæµåŠ¨çš„ç°ä»£æ€§â€ï¼ˆLiquid Modernityï¼‰ã€‚

å¥¥å¾·ä¿®æ–¯çš„å¹¸è¿åœ¨äºï¼Œä»–çš„â€œä¼Šè¨å¡â€æ˜¯åœ°ç†ä¸ç¤¾ä¼šç»“æ„ä¸­å›ºå®šçš„é”šç‚¹ã€‚ä½†å½“ä»£äººçš„ç”Ÿå­˜ç°å®å‘ç”Ÿäº†ç»“æ„æ€§æ–­è£‚ï¼š
* **å®å¤§å™äº‹çš„è§£ä½“**ï¼šç¤¾ä¼šä¸å†æä¾›ç»Ÿä¸€çš„æ„ä¹‰å‰§æœ¬ã€‚
* **èº«ä»½çš„æ¶²åŒ–**ï¼šèŒä¸šã€å±…ä½åœ°ã€äººé™…å…³ç³»çš†å¤„äºç¬æ¯ä¸‡å˜ä¹‹ä¸­ã€‚

æˆ‘ä»¬é¢ä¸´ç€ä¸€ç§æ·±åˆ»çš„â€œæœ¬ä½“æ€§ä¸å®‰å…¨æ„Ÿâ€ï¼ˆOntological Insecurityï¼‰ã€‚å¦‚æœåœ¨å¤–éƒ¨ä¸–ç•Œæ‰¾ä¸åˆ°åšå›ºçš„ä¼Šè¨å¡ï¼Œä¸ªä½“ä¾¿å¦‚åŒå¤±å»äº†åæ ‡çš„èˆªèˆ¹ã€‚è¿™æ­£æ˜¯å½“ä»£ç„¦è™‘çš„æ ¹æºï¼š**æˆ‘ä»¬æ‹¥æœ‰è®²è¿°çš„æ¬²æœ›ï¼Œå´å¤±å»äº†è®²è¿°çš„å‚ç…§ç³»ã€‚**

---

## ç¬¬å››ç« ï¼šä½œä¸ºè§£å†³æ–¹æ¡ˆçš„ä¹¦å†™

é¢å¯¹ç°ä»£ç”Ÿæ´»çš„æµåŠ¨ä¸è™šæ— ï¼Œæœ¬ä¹¦æå‡ºäº†ä¸€ç§åŸºäºâ€œä¹¦å†™â€çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æˆ‘ä»¬éœ€è¦è­¦æƒ•çš„æ˜¯ï¼Œä¹¦å†™å¹¶éä¸€ç§ä¸ºäº†æ¶ˆé™¤ç„¦è™‘è€Œè¿›è¡Œçš„â€œå¼ºåˆ¶å½’æ¡£â€ã€‚

ä¹¦å†™çš„ç»ˆæç›®æ ‡æ˜¯â€œæ•´åˆâ€ï¼Œä½†æ•´åˆå¹¶ä¸æ„å‘³ç€æ¶ˆé™¤çŸ›ç›¾ã€‚

æ°æ°ç›¸åï¼ŒçœŸæ­£çš„æ•´åˆæ„å‘³ç€æ‰¿è®¤å¼ åŠ›çš„ä¸å¯é¿å…ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè·å¾—ä¸€ç§ç²¾ç¥ä¸Šçš„è±è¾¾ã€‚å¦‚æœæˆ‘ä»¬å°†ç”Ÿæ´»å¼ºè¡Œå‰ªè£æˆä¸€ä¸ªé€»è¾‘å®Œç¾çš„å‰§æœ¬ï¼Œé‚£åªä¼šè®©æˆ‘ä»¬çš„ç”Ÿå‘½å˜å¾—ç‹­çª„ä¸è´«ç˜ ã€‚

ä»¥äººç±»ç”Ÿå­˜ä¸­æœ€åŸºæœ¬çš„ä¸€å¯¹çŸ›ç›¾â€œç¡®å®šæ€§â€ä¸â€œä¸ç¡®å®šæ€§â€ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ‰æ„è¯†çš„ä¹¦å†™ï¼Œå¸®åŠ©è¯»è€…åœ¨ä¸¤ä¸ªç»´åº¦ä¸Šå±•å¼€è¡ŒåŠ¨ï¼š

1. ç¡®ç«‹èƒ½åŠ¨æ€§ï¼ˆAgencyï¼‰ï¼šä¸€æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å™äº‹æ¥å˜æ¸…è‡ªæˆ‘ï¼Œå……åˆ†å‘æŒ¥ä¸»è§‚èƒ½åŠ¨æ€§ï¼Œå»è§„åˆ’ã€è¿½æ±‚å¹¶å®ç°é‚£äº›å±äºä½ çš„ç›®æ ‡ä¸ç†æƒ³ã€‚

2. æ¥çº³å¶ç„¶æ€§ï¼ˆContingencyï¼‰ï¼šå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦é€šè¿‡å™äº‹å»æ‹¥æŠ±å¼€æ”¾æ€§ï¼Œæ¥çº³ç”Ÿæ´»ä¸­çš„æ„å¤–ã€æ–­è£‚ä¸ä¸å¯æ§ï¼Œä»è€Œæœ‰å‹‡æ°”è¸ä¸Šä¸€æ®µæ„æ–™ä¹‹å¤–çš„æ—…ç¨‹ã€‚

æˆ‘ä»¬ç›¸ä¿¡ï¼Œæ¯ä¸€ä¸ªäººçš„ç”Ÿæ´»éƒ½æ˜¯ä¸€éƒ¨å€¼å¾—è®°å½•çš„å²è¯—ã€‚åœ¨è¿™ä¸ªå®å¤§çš„æ—¶ä»£èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬çœŸè¯šåœ°**æ¸´æœ›å¬åˆ°æ›´å¤šäººå»è®²è¿°è‡ªå·±çš„æ•…äº‹**â€”â€”æ— è®ºæ˜¯å…³äºç¡®å®šçš„æ¢¦æƒ³ï¼Œè¿˜æ˜¯å…³äºæœªçŸ¥çš„è¿·æƒ˜ã€‚

æ­£æ˜¯è¿™äº›åƒå·®ä¸‡åˆ«çš„å£°éŸ³ï¼Œæ±‡èšæˆäº†æˆ‘ä»¬å¯¹è¿™ä¸ªä¸–ç•Œæœ€çœŸå®çš„ç†è§£ã€‚
è¯·ç¿»å¼€ä¸‹ä¸€é¡µã€‚èˆå°å·²ç»å¤‡å¥½ï¼Œç°åœ¨ï¼Œè½®åˆ°ä½ æ¥è®²æ•…äº‹äº†ã€‚
`
};

const GUIDE_BOOK_II = {
    id: "guide_book_part2",
    title: "ä¼Šè¨å¡æ‰‹è®° II",
    cover: "assets/images/booksheet/booksheet0.png",
    date: "ç³»ç»ŸæŒ‡å—",
    isReadOnly: true, // ğŸ”’ æ ¸å¿ƒæ ‡è®°ï¼šåªè¯»
    content: `
å¾…å†™...
`
};

const GUIDE_BOOK_III = {
    id: "guide_book_part3",
    title: "ä¼Šè¨å¡æ‰‹è®° III",
    cover: "assets/images/booksheet/booksheet0.png",
    date: "ç³»ç»ŸæŒ‡å—",
    isReadOnly: true, // ğŸ”’ æ ¸å¿ƒæ ‡è®°ï¼šåªè¯»
    content: `
å¾…å†™...
`
};

const GUIDE_BOOK_IV = {
    id: "guide_book_part4",
    title: "ä¼Šè¨å¡æ‰‹è®° IV",
    cover: "assets/images/booksheet/booksheet0.png",
    date: "ç³»ç»ŸæŒ‡å—",
    isReadOnly: true, // ğŸ”’ æ ¸å¿ƒæ ‡è®°ï¼šåªè¯»
    content: `
å¾…å†™â€¦â€¦
`
};

export const Library = {
    books: [],
    
   async init() {
        // 1. è¯»å–å­˜æ¡£
        const saved = await window.ithacaSystem.loadData('library_data.json');
        
        // ğŸ›¡ï¸ã€å…³é”®ä¿®å¤ã€‘å®‰å…¨åŠ è½½é€»è¾‘
        let loadedBooks = [];
        if (saved) {
            try {
                const parsed = JSON.parse(saved);
                // å¿…é¡»ç¡®ä¿å®ƒæ˜¯æ•°ç»„ï¼Œå¦‚æœæ˜¯å¯¹è±¡ {} åˆ™å›é€€ä¸ºç©ºæ•°ç»„ []
                if (Array.isArray(parsed)) {
                    loadedBooks = parsed;
                } else {
                    console.warn("[Library] è­¦å‘Šï¼šlibrary_data.json æ ¼å¼ä¸æ­£ç¡®(ä¸æ˜¯æ•°ç»„)ï¼Œå·²è‡ªåŠ¨é‡ç½®ä¸ºç©ºä¹¦æ¶ã€‚");
                }
            } catch (err) {
                console.error("[Library] JSON è§£æå¤±è´¥ï¼Œé‡ç½®ä¸ºç©º:", err);
            }
        }
        this.books = loadedBooks;

        // --- ğŸ§¹ ç°æœ‰é€»è¾‘ï¼šæ¸…ç†æ—§çš„ç³»ç»Ÿä¹¦ ---
        // (ç”±äºä¸Šé¢ä¿è¯äº† this.books ç»å¯¹æ˜¯æ•°ç»„ï¼Œè¿™ä¸€è¡Œç°åœ¨å®‰å…¨äº†)
        this.books = this.books.filter(b => {
            const isOldSystemBook = (b.title.includes("ä¼Šè¨å¡æ‰‹è®°") && b.id !== GUIDE_BOOK_I.id && !b.isMystery);
            return !isOldSystemBook;
        });

        // --- ğŸ› ï¸ ç°æœ‰é€»è¾‘ï¼šæ³¨å…¥/æ›´æ–°ã€Šä¼Šè¨å¡æ‰‹è®° Iã€‹ ---
        const guideIndex = this.books.findIndex(b => b.id === GUIDE_BOOK_I.id);
        if (guideIndex === -1) {
            this.books.unshift(GUIDE_BOOK_I);
        } else {
            this.books[guideIndex] = { 
                ...this.books[guideIndex], 
                content: GUIDE_BOOK_I.content,
                isReadOnly: true,
                title: GUIDE_BOOK_I.title
            };
        }

        // ============================================================
        // âœ¨ ç°æœ‰é€»è¾‘ï¼šå¼ºåˆ¶æ›´æ–°ã€Šç³–æ°´è èçš„æ—¥è®°ã€‹çš„å°é¢
        // ============================================================
        const targetBookId = "book_pineapple_diary_complete";
        const pineappleBook = this.books.find(b => b.id === targetBookId);
        
        if (pineappleBook) {
            pineappleBook.cover = "assets/images/booksheet/booksheet1.png"; 
            pineappleBook.isReadOnly = true; 
        }

        // 3. ä¿å­˜æ›´æ”¹åˆ°ç¡¬ç›˜ (è¿™ä¼šæŠŠæ­£ç¡®çš„æ•°ç»„æ ¼å¼å†™å›æ–‡ä»¶ï¼Œå½»åº•ä¿®å¤åæ¡£)
        this.save(); 
    },

    // === âœ¨ æ–°å¢åŠŸèƒ½ï¼šè§£é”ç‰¹å®šçš„ç³»ç»Ÿä¹¦ç± ===
    unlockSystemBook(partNumber) {
        let targetBook = null;
        switch(partNumber) {
            case 2: targetBook = GUIDE_BOOK_II; break;
            case 3: targetBook = GUIDE_BOOK_III; break;
            case 4: targetBook = GUIDE_BOOK_IV; break;
        }

        if (targetBook) {
            // æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œé¿å…é‡å¤æ·»åŠ 
            const exists = this.books.find(b => b.id === targetBook.id);
            if (!exists) {
                this.books.unshift(targetBook); // åŠ åˆ°æœ€å‰é¢
                this.save();
                console.log(`[Library] å·²è§£é”ç³»ç»Ÿä¹¦ç±ï¼š${targetBook.title}`);
                return true;
            }
        }
        return false;
    },

    // å¢
    addBook(book) {
        this.books.push(book);
        this.save();
    },

    // ç‰¹æ®Šå¢åŠ é€»è¾‘
    addMysteryBook(data) {
        const mysteryBook = {
            id: "mystery_book_01", // è¿™é‡Œå¦‚æœä»¥åæœ‰å¤šæœ¬ç¥ç§˜ä¹¦ï¼Œå»ºè®®ç”¨ uuid æˆ–ä¼ å…¥ ID
            title: data.title,
            author: data.author,
            content: data.content,
            cover: data.cover,
            isMystery: true,
            isCollected: true
        };
        
        if (!this.books.find(b => b.id === mysteryBook.id)) {
            this.books.unshift(mysteryBook);
            this.save();
        }
    },

    // æ”¹ (åˆå¹¶åçš„ç‰ˆæœ¬)
    updateBook(id, title, content) {
        const book = this.books.find(b => b.id === id);
        if (book) {
            // ğŸ”’ ä¿æŠ¤é€»è¾‘
            if (book.isReadOnly) {
                console.warn("è¯•å›¾ä¿®æ”¹åªè¯»ä¹¦ç±ï¼Œæ“ä½œè¢«æ‹¦æˆª");
                return false; // è¿”å› false è¡¨ç¤ºå¤±è´¥
            }
            book.title = title;
            book.content = content;
            this.save();
            return true; // è¿”å› true è¡¨ç¤ºæˆåŠŸ
        }
        return false;
    },

    // åˆ  (åˆå¹¶åçš„ç‰ˆæœ¬ï¼Œå»æ‰äº† deleteBookï¼Œç»Ÿä¸€ç”¨ removeBook)
    removeBook(id) {
        const book = this.books.find(b => b.id === id);
        
        // ğŸ”’ ä¿æŠ¤é€»è¾‘
        if (book && book.isReadOnly) {
            console.warn(`ä¹¦ç± ${book.title} æ˜¯ç³»ç»Ÿä¹¦ç±ï¼Œæ— æ³•é”€æ¯ã€‚`);
            return false; 
        }

        const initialLength = this.books.length;
        this.books = this.books.filter(b => b.id !== id);
        
        if (this.books.length !== initialLength) {
            this.save();
            return true;
        }
        return false;
    },

    // è¾…åŠ©æŸ¥è¯¢ï¼šæ£€æŸ¥æŸæœ¬ä¹¦æ˜¯å¦å·²åœ¨ä¹¦æ¶ä¸Š (ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦è§¦å‘å‰§æƒ…)
    hasBook(bookId) {
        return this.books.some(b => b.id === bookId);
    },

    // æŸ¥
    getAll() {
        return this.books;
    },

    // âœ¨ æ–°å¢ï¼šé‡ç½®å›¾ä¹¦é¦†ï¼ˆæ¸…ç©ºæ‰€æœ‰ä¹¦ç±ï¼Œä½†ä¿ç•™ç³»ç»ŸæŒ‡å—ï¼‰
    reset() {
        // ä¿®å¤ï¼šä¸ç›´æ¥æ¸…ç©ºä¸º []ï¼Œè€Œæ˜¯è¿‡æ»¤ä¿ç•™åªè¯»ä¹¦ç±ï¼ˆå¦‚ç³»ç»ŸæŒ‡å—ã€å‰§æƒ…é“å…·ä¹¦ï¼‰
        this.books = this.books.filter(b => b.isReadOnly);
        
        // å…œåº•ï¼šå¦‚æœè¿‡æ»¤åå‘ç°æŒ‡å—ä¸åœ¨äº† (æå°æ¦‚ç‡)ï¼Œå¼ºåˆ¶åŠ å›æ¥
        const hasGuide = this.books.some(b => b.id === GUIDE_BOOK_I.id);
        if (!hasGuide) {
             this.books.unshift(GUIDE_BOOK_I);
        }

        // 3. ä¿å­˜
        this.save();
        console.log("ğŸ“š å›¾ä¹¦é¦†å·²é‡ç½® (ä¿ç•™äº†ç³»ç»Ÿä¹¦ç±)");
    },

    // å­˜
    save() {
        window.ithacaSystem.saveData('library_data.json', JSON.stringify(this.books));
    }
};